#!/usr/bin/env ruby
$:.unshift __dir__ + '/../../lib'
require 'hanami/cli'

module Foo
  module CLI
    include Hanami::Cli

    class Hello
      include Hanami::Cli::Command

      register 'hello'

      def call
      end
    end

    class Version
      include Hanami::Cli::Command

      register 'version'
      aliases '--version', '-v'

      def call
        puts "v1.0.0"
      end
    end

    class Server
      include Hanami::Cli::Command

      register 'server'

      desc 'Starts a hanami server'

      param :port, alias: '-p', desc: 'The port to run the server on'
      param :server
      param :host

      def call(**options)
        puts "Server: #{parsed_options}"
      end
    end

    class New
      include Hanami::Cli::Command

      register 'new'

      desc 'Creates a new hanami project'

      param :project_name, required: true

      def call(project_name:)
        puts "New: #{parsed_options} - project_name: #{project_name}"
      end
    end

    module Destroy
      class Subcommand
        include Hanami::Cli::Command

        register 'destroy', subcommand: true

        desc 'Destroy hanami classes'
      end

      class Action
        include Hanami::Cli::Command

        register 'destroy action'

        param :application_name, required: true
        param :controller_name__action_name, required: true, label: "CONTROLLER_NAME#ACTION_NAME"
        param :url

        def call(application_name:, controller_name__action_name:)
          puts "destroy action: #{parsed_options} - application_name: #{application_name} - controller_name__action_name: #{controller_name__action_name}"
        end
      end
    end

    module Generate
      class Subcommand
        include Hanami::Cli::Command

        register 'generate', subcommand: true

        desc 'Generate hanami classes'
      end

      class Model
        include Hanami::Cli::Command

        register 'generate model'

        desc 'Generate an entity'

        param :name, alias: '-n', desc: 'use the name for generating the model'
        param :model_name, required: true

        def call(model_name:)
          puts "generated model: #{parsed_options} - model_name: #{model_name}"
        end
      end

      class Action
        include Hanami::Cli::Command

        register 'generate action'

        def call
        end
      end
    end
  end
end

module Webpack
  module Commands
    include Hanami::Cli

    class Hi
      include Hanami::Cli::Command

      register 'hello'

      def call
        puts "world"
      end
    end

    module Generate
      class Configuration
        include Hanami::Cli::Command

        register 'generate webpack'

        def call
          puts "generated configuration"
        end
      end

      class Action
        include Hanami::Cli::Command

        register 'generate action'

        desc 'Generate an action'

        def call
          puts "generated action"
        end
      end

      module Application
        class Subcommand
          include Hanami::Cli::Command

          register 'generate application', subcommand: true

          desc 'Generate hanami applications'
        end

        class New
          include Hanami::Cli::Command

          register 'generate application new'

          desc 'Generate an application'

          def call
            puts "generated application new: #{parsed_options}"
          end
        end
      end
    end
  end
end

Foo::CLI.call
